Q1
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans
from sklearn.metrics import silhouette_score

df = pd.read_csv("diabetes.csv")

df = df.dropna()
X = df.select_dtypes(include=[np.number])

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

wcss = []
K_range = range(1,9)
for k in K_range:
    km = KMeans(n_clusters=k, random_state=42, n_init=10)
    km.fit(X_scaled)
    wcss.append(km.inertia_)

plt.plot(list(K_range), wcss, marker='o')
plt.xlabel("k")
plt.ylabel("WCSS (inertia)")
plt.title("Elbow Method")
plt.grid(True)
plt.show()

k = 3
kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)
labels = kmeans.fit_predict(X_scaled)

centers_scaled = kmeans.cluster_centers_
centers = scaler.inverse_transform(centers_scaled)

print(f"\nUsing k = {k}")
print("\nCluster centers (original scale):")
for i, c in enumerate(centers):
    print(f" Cluster {i}: " + ", ".join(f"{col}={val:.3f}" for col, val in zip(X.columns, c)))

counts = pd.Series(labels).value_counts().sort_index()
print("\nCluster counts:")
print(counts)

if k >= 2 and len(X_scaled) > k:
    sil = silhouette_score(X_scaled, labels)
    print(f"\nSilhouette Score: {sil:.4f}")

out = df.copy().reset_index(drop=True)
out['Cluster'] = labels
out.to_csv("diabetes_with_clusters.csv", index=False)
print("\nSaved clustered data to 'diabetes_with_clusters.csv'")

Q2
# Name :Sanat Pillai ,Rushikesh Valvi  Roll No.: 24,15
# Assignment No.: 3

import pandas as pd
import math 
import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score

import warnings
warnings.filterwarnings("ignore")
df =pd.read_csv(r'ML\Position_Salaries.csv')
print(df)

print("\nPosition Salaries Description : ")
print(df.describe())

print("\nPosition Salaries Information : ")
print(df.info())

X = df[['Level']].values
print(X)

y = df['Salary'].values
print(y)

X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=42)
print("\n\nPolynomial Regression : \n")

for d in range(1, 7):
    feature = PolynomialFeatures(degree=d)
    X_poly_train=feature.fit_transform(X_train)
    X_poly_test=feature.transform(X_test)
    plr_model=LinearRegression()
    plr_model.fit(X_poly_train,y_train)


    y_poly_pred= plr_model.predict(X_poly_test)

    X_grid = np.arange(min(X), max(X), 0.1).reshape(-1, 1)
    plt.scatter(X, y, color="red")
    plt.plot(X_grid, plr_model.predict(feature.transform(X_grid)), color="green", label="Polynomial Regression")
    plt.title(f'Salary vs Level (Polynomial Regression)-Degree {d}')
    plt.xlabel("Level")
    plt.ylabel("Salary")
    plt.legend()
    plt.show()

print("Degree : ",d)
print("\nMSE:", mean_squared_error(y_test, y_poly_pred))
print("\nRoot MSE: ",math.sqrt(mean_squared_error(y_test,y_poly_pred)))
print("\nMean Absolute Error",mean_absolute_error(y_test,y_poly_pred))
print("\nRÂ² Score:", r2_score(y_test, y_poly_pred))

print("\nCoefficient :  ",plr_model.coef_)
print("\nIntercept :  ",plr_model.intercept_)

print("Prediction for Level 11 : ",plr_model.predict(feature.transform([[11]]))[0])
print("Prediction for Level 12 : ",plr_model.predict(feature.transform([[12]]))[0])



