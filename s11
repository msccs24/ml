import pandas as pd
import math 
import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score

import warnings
warnings.filterwarnings("ignore")
df =pd.read_csv(r'ML\Position_Salaries.csv')
print(df)
print("\nPosition Salaries Description : ")
print(df.describe())
print("\nPosition Salaries Information : ")
print(df.info())

X = df[['Level']].values
print(X)

y = df['Salary'].values
print(y)

X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=42)
print("\n\nPolynomial Regression : \n")

for d in range(1, 7):
    feature = PolynomialFeatures(degree=d)
    X_poly_train=feature.fit_transform(X_train)
    X_poly_test=feature.transform(X_test)
    plr_model=LinearRegression()
    plr_model.fit(X_poly_train,y_train)


    y_poly_pred= plr_model.predict(X_poly_test)

    X_grid = np.arange(min(X), max(X), 0.1).reshape(-1, 1)
    plt.scatter(X, y, color="red")
    plt.plot(X_grid, plr_model.predict(feature.transform(X_grid)), color="green", label="Polynomial Regression")
    plt.title(f'Salary vs Level (Polynomial Regression)-Degree {d}')
    plt.xlabel("Level")
    plt.ylabel("Salary")
    plt.legend()
    plt.show()

print("Degree : ",d)
print("\nMSE:", mean_squared_error(y_test, y_poly_pred))
print("\nRoot MSE: ",math.sqrt(mean_squared_error(y_test,y_poly_pred)))
print("\nMean Absolute Error",mean_absolute_error(y_test,y_poly_pred))
print("\nRÂ² Score:", r2_score(y_test, y_poly_pred))

print("\nCoefficient :  ",plr_model.coef_)
print("\nIntercept :  ",plr_model.intercept_)

print("Prediction for Level 11 : ",plr_model.predict(feature.transform([[11]]))[0])
print("Prediction for Level 12 : ",plr_model.predict(feature.transform([[12]]))[0])

Q2
import pandas as pd
import numpy as np
import math
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn import tree
from sklearn.tree import DecisionTreeClassifier,plot_tree
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report,roc_auc_score, roc_curve
import warnings
warnings.filterwarnings("ignore")

data = pd.read_csv(r'ML\BankNote_Authentication.csv')
print("Original Data set")
print(data)

X=data.drop(['class'],axis='columns')
y=data['class']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

decisiontree=tree.DecisionTreeClassifier()
decisiontree.fit(X_train,y_train)

y_pred=decisiontree.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
print("Accuracy Score: ",accuracy)

class_report = classification_report(y_test, y_pred)
print("Classification Report: ",class_report)

conf_matrix = confusion_matrix(y_test, y_pred)
print("Confusion Matrix:\n",conf_matrix)

plt.figure(figsize=(6,4))
sns.heatmap(conf_matrix,annot=True, fmt='d', cmap='Blues',xticklabels=['Not Survived', 'Survived'],yticklabels=['Not Survived', 'Survived'])
plt.title('Confusion Matrix Heatmap')
plt.xlabel('Predicted')
plt.ylabel('Actual')
plt.show()

y_prob = decisiontree.predict_proba(X_test)[:, 1] 
fpr, tpr, thresholds = roc_curve(y_test, y_prob)
auc_score = roc_auc_score(y_test, y_prob)
print("ROC_AUC Score: ",auc_score)

plt.figure(figsize=(6, 4))
plt.plot(fpr, tpr, color='darkorange', lw=2, label=f'ROC curve (AUC = {auc_score:.2f})')
plt.xlabel('False Positive Rate')
plt.ylabel('True Positive Rate')
plt.title('ROC Curve for Decision Tree Classifier')
plt.legend(loc="lower right")
plt.grid(True)
plt.show()

plt.figure(figsize=(15,8))
tree.plot_tree(decisiontree,filled=True,feature_names=X.columns,rounded=True,class_names=['Genuine(True)','Forged(False)'])
plt.title('Decision Tree Visualization')
plt.show()


