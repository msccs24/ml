import pandas as pd
import numpy as np
import math
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score
import warnings
warnings.filterwarnings("ignore")

df =pd.read_csv(r'ML\minihomeprices.csv')
print("Original Data set")
print(df)

df.dropna(inplace=True)
print(df)

med = math.floor(df.bedrooms.median())
print(" Median : ",med)
df.bedrooms=df.bedrooms.fillna(med)
print("Replacing Missing values by Median... Modified Data set")
print(df)

df['combined']=df['area']*df['bedrooms']/df['age']
print("Combined : \n",df)
df=df.drop(index=2)
print(df)

X=df['combined'].values.reshape(-1,1)
X = df[['area','bedrooms','age']]
y = df['price']

from sklearn.model_selection import train_test_split
X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=42)

from sklearn.linear_model import LinearRegression
mlr_model = LinearRegression()
mlr_model.fit(X_train,y_train)
y_pred=mlr_model.predict(X_test)
mlr_model.fit(df[['area','bedrooms','age']],df['price'])

print(" Coefficients m1 for Area , m2 for Bedrooms and m3 for Age  : ",mlr_model.coef_)
print(" Intercept : ",mlr_model.intercept_)

comparison_df=pd.DataFrame({'Actual_price :':y_test,'Predicted_price:':y_pred})
print(comparison_df)

mse = mean_squared_error(y_test, y_pred)
rmse = math.sqrt(mse)
mae = mean_absolute_error(y_test, y_pred)
r_squared = r2_score(y_test, y_pred)
print(f"Mean Squared Error (MSE):", mse)
print(f"Root Mean Squared Error (RMSE):", rmse)
print(f"Mean Absolute Error (MAE):", mae)
print(f"R-squared (RÂ²):", r_squared)
score=mlr_model.score(y_test,y_pred)
print(f"R^2 score:{score*100:.2f}%")

y_pred = mlr_model.predict([[ 4000, 2, 10 ]])
print("prediction for mlr_model.predict[[ 4000, 2, 10  ]] : ",y_pred)
y_pred = mlr_model.predict([[ 3000, 3, 6 ]])
print("prediction for mlr_model.predict([[ 3000, 3, 6 ]] : ",y_pred)
y_pred = mlr_model.predict([[ 2500, 4, 5 ]])
print("prediction for mlr_model.predict([[ 2500, 4, 5]] : ",y_pred)

Q2
import pandas as pd
import numpy as np
import math
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report,roc_auc_score, roc_curve

df = pd.read_csv(r'ML\crash.csv')
print("Original Data set")
print(df)
print("\nDescription of Dataset:")
print(df.describe())
print("\nInformation about the Dataset:")
print(df.info())

print(" Predictor : ")
X = df[['age','speed']]
print(X)

print("Target : ")
y = df['sur_id']
print(y)

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

LR_model = LogisticRegression()
LR_model.fit(X_train, y_train)

y_pred = LR_model.predict(X_test)
print("y_pred",y_pred)

print("Coefficients of Logistic Regression: ",LR_model.coef_)

print("Intercept of Logistic Regression: ",LR_model.intercept_)

accuracy = accuracy_score(y_test, y_pred)
print("Accuracy Score: ",accuracy)

conf_matrix = confusion_matrix(y_test, y_pred)
print("Confusion Matrix:\n",conf_matrix)

plt.figure(figsize=(6,4))
sns.heatmap(conf_matrix,annot=True, fmt='d', cmap='Blues',xticklabels=['Not Survived', 'Survived'],yticklabels=['Not Survived', 'Survived'])
plt.title('Confusion Matrix Heatmap')
plt.xlabel('Predicted')
plt.ylabel('Actual')
plt.show()

class_report = classification_report(y_test, y_pred)
print("Classification Report: ",class_report)

roc_auc=roc_auc_score(y_test,y_pred)
print("ROC_AUC Score: ",roc_auc)

fpr,tpr,thresho = roc_curve(y_test,y_pred)
plt.plot(fpr,tpr,marker="+",color="red")
plt.xlabel('False Positive Rate')
plt.ylabel('True Positive Rate')
plt.title('ROC Curve')
plt.show()
