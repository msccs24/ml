import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression


df = pd.read_csv("housing.csv") 

X = df[['Area']]      # example feature: Area in sq ft
y = df['Price']       # house price

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

model = LinearRegression()
model.fit(X_train, y_train)

y_pred = model.predict(X_test)
print("Predicted Prices:", y_pred[:5])
print("Actual Prices:   ", y_test.values[:5])
print("Model Coefficient:", model.coef_[0])
print("Model Intercept:", model.intercept_)


Q2
import pandas as pd
from mlxtend.preprocessing import TransactionEncoder
from mlxtend.frequent_patterns import apriori, association_rules

dataset = []
with open(r"ML\groceries.csv") as f:
    for line in f:
        items = line.strip().split(',')
        dataset.append(items)

print("Sample transactions:")
for t in dataset[:5]:
    print(t)

te = TransactionEncoder()
te_ary = te.fit(dataset).transform(dataset)
df = pd.DataFrame(te_ary, columns=te.columns_)

df = df.fillna(False)
df = df.astype(bool)

print("\n Encoded DataFrame:")
print(df.head())

frequent_itemsets = apriori(df, min_support=0.25, use_colnames=True)

print("\nFrequent Itemsets (Support â‰¥ 0.25):")
print(frequent_itemsets)

rules = association_rules(frequent_itemsets, metric="lift", min_threshold=1)
print("\n Association Rules:")
print(rules[['antecedents', 'consequents', 'support', 'confidence', 'lift']])
